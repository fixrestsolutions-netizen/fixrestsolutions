<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FixRest | Property Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .hide { display: none !important; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .cart-badge { position: absolute; top: -8px; right: -8px; background-color: #f97316; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 min-h-screen font-sans">

    <script>
        // *** PASTE YOUR GOOGLE SCRIPT URL HERE ***
        const API_URL = "https://script.google.com/macros/s/AKfycbw-Je7rTP8z7VxpSc120_0Ua0nieP96T8l3BMS_eKGwGNbM6fTCDF2p_iV7QsCubALM5Q/exec"; 
        
        let currentUser = JSON.parse(localStorage.getItem('fixrest_user')) || null;
        let cart = JSON.parse(localStorage.getItem('fixrest_cart')) || [];
    </script>

    <nav class="bg-slate-800 sticky top-0 z-40 shadow-lg border-b border-slate-700">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2 cursor-pointer" onclick="router('home')">
                <div class="bg-orange-500 w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold">FR</div>
                <span class="text-xl font-bold text-white hidden md:block">FixRest</span>
            </div>
            
            <div class="flex items-center space-x-4">
                <button id="admin-link" class="text-red-500 font-bold text-sm hide" onclick="router('admin')">ADMIN PANEL</button>
                <button onclick="router('dashboard')" id="nav-dash" class="text-slate-300 hover:text-white hide">Dashboard</button>
                
                <button id="cart-btn" onclick="document.getElementById('cart-modal').classList.remove('hide'); renderCart();" class="relative text-slate-300 hover:text-orange-400 hide">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <div id="cart-badge" class="cart-badge hide">0</div>
                </button>
                
                <div id="auth-ui"></div>
            </div>
        </div>
    </nav>

    <section id="home" class="fade-in">
        <div class="py-20 text-center px-4 bg-gradient-to-b from-slate-800 to-slate-900">
            <h1 class="text-4xl md:text-6xl font-bold text-white mb-6">Yield without <span class="text-orange-500">Yielding</span></h1>
            <p class="text-slate-400 mb-8 max-w-xl mx-auto">Complete property management for South Africa. We handle the stress, you handle the bank balance.</p>
            <button onclick="router('login')" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg">Get Started</button>
        </div>
        
        <div class="container mx-auto px-4 py-10 pb-20">
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-orange-500 transition">
                    <h3 class="text-xl font-bold text-white">Co-Hosting Setup</h3>
                    <p class="text-3xl font-bold text-orange-500 my-2">R 499</p>
                    <ul class="text-sm text-slate-400 mb-4 list-disc ml-4"><li>Listing Creation</li><li>Keybox Install</li><li>Vetting</li></ul>
                    <button onclick="addToCart('Co-Hosting Setup', 499)" class="w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded">Add to Cart</button>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-orange-500 relative transform md:-translate-y-4 shadow-xl">
                    <div class="absolute top-0 right-0 bg-orange-500 text-white text-xs px-2 py-1 rounded-bl">POPULAR</div>
                    <h3 class="text-xl font-bold text-white">Deep Clean</h3>
                    <p class="text-3xl font-bold text-orange-500 my-2">R 850</p>
                    <ul class="text-sm text-slate-400 mb-4 list-disc ml-4"><li>Full Turnover</li><li>Linen Change</li><li>Restocking</li></ul>
                    <button onclick="addToCart('Deep Clean', 850)" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded">Add to Cart</button>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-orange-500 transition">
                    <h3 class="text-xl font-bold text-white">Admin Fixer</h3>
                    <p class="text-3xl font-bold text-orange-500 my-2">R 350</p>
                    <ul class="text-sm text-slate-400 mb-4 list-disc ml-4"><li>Queue Standing</li><li>Doc Delivery</li><li>Hourly Rate</li></ul>
                    <button onclick="addToCart('Admin Hour', 350)" class="w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <section id="login" class="hide py-16 px-4">
        <div class="max-w-md mx-auto bg-slate-800 p-8 rounded-xl border border-slate-700 shadow-2xl">
            <div class="flex mb-6 border-b border-slate-700">
                <button onclick="toggleAuth('login')" id="tab-l" class="flex-1 pb-2 text-orange-500 border-b-2 border-orange-500 font-bold">Login</button>
                <button onclick="toggleAuth('register')" id="tab-r" class="flex-1 pb-2 text-slate-400">Register</button>
            </div>
            
            <form id="login-form">
                <input type="email" id="l-email" placeholder="Email Address" class="w-full mb-4 bg-slate-700 rounded py-3 px-4 text-white border border-slate-600 focus:border-orange-500 outline-none">
                <input type="password" id="l-pass" placeholder="Password" class="w-full mb-4 bg-slate-700 rounded py-3 px-4 text-white border border-slate-600 focus:border-orange-500 outline-none">
                <button type="submit" id="l-btn" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded font-bold">Sign In</button>
            </form>

            <form id="register-form" class="hide">
                <input type="text" id="r-name" placeholder="Full Name" class="w-full mb-4 bg-slate-700 rounded py-3 px-4 text-white border border-slate-600 outline-none">
                <input type="email" id="r-email" placeholder="Email Address" class="w-full mb-4 bg-slate-700 rounded py-3 px-4 text-white border border-slate-600 outline-none">
                
                <div class="flex mb-4">
                    <span class="bg-slate-600 px-3 py-3 rounded-l text-slate-300 flex items-center border border-r-0 border-slate-600 font-mono">üáøüá¶ +27</span>
                    <input type="tel" id="r-phone" placeholder="82 123 4567" oninput="formatPhone(this)" class="w-full bg-slate-700 rounded-r py-3 px-4 text-white border border-slate-600 outline-none">
                </div>
                
                <input type="password" id="r-pass" placeholder="Create Password" class="w-full mb-4 bg-slate-700 rounded py-3 px-4 text-white border border-slate-600 outline-none">
                <button type="submit" id="r-btn" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded font-bold">Create Account</button>
            </form>
        </div>
    </section>

    <section id="dashboard" class="hide py-10 px-4">
        <div class="container mx-auto max-w-6xl">
            <h1 class="text-3xl font-bold text-white mb-6">Welcome, <span id="user-name" class="text-orange-500"></span></h1>
            
            <div class="grid md:grid-cols-3 gap-6">
                <div class="md:col-span-1 bg-slate-800 rounded-xl p-4 border border-slate-700 h-96 overflow-y-auto">
                    <h3 class="text-slate-400 font-bold mb-4 uppercase text-xs tracking-wide">Notifications</h3>
                    <div id="notif-list" class="space-y-3">Loading...</div>
                </div>

                <div class="md:col-span-2 bg-slate-800 rounded-xl p-4 border border-slate-700 h-96 overflow-y-auto">
                    <h3 class="text-slate-400 font-bold mb-4 uppercase text-xs tracking-wide">Order History</h3>
                    <table class="w-full text-left text-sm text-slate-300">
                        <thead class="text-xs uppercase bg-slate-700 text-slate-400">
                            <tr><th class="p-3">ID</th><th class="p-3">Date</th><th class="p-3">Amount</th><th class="p-3">Status</th></tr>
                        </thead>
                        <tbody id="order-list"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <section id="admin" class="hide py-6 px-4 bg-slate-950 min-h-screen">
        <div class="container mx-auto">
            <div class="flex justify-between items-center mb-8 border-b border-slate-800 pb-4">
                <h1 class="text-2xl font-bold text-red-500 flex items-center gap-2"><i class="fas fa-lock"></i> ADMIN CONSOLE</h1>
                <button onclick="loadAdminData()" class="text-sm bg-slate-800 text-slate-400 px-3 py-1 rounded hover:text-white">Refresh Data</button>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-slate-900 p-4 rounded border border-slate-800">
                    <p class="text-slate-500 text-xs uppercase">Total Sales</p>
                    <p class="text-2xl font-bold text-green-500" id="adm-sales">R0</p>
                </div>
                <div class="bg-slate-900 p-4 rounded border border-slate-800">
                    <p class="text-slate-500 text-xs uppercase">Registered Users</p>
                    <p class="text-2xl font-bold text-white" id="adm-users">0</p>
                </div>
            </div>

            <h3 class="text-white font-bold mb-3 border-l-4 border-yellow-500 pl-3">Pending Orders (Action Required)</h3>
            <div class="bg-slate-900 rounded overflow-x-auto mb-8 border border-slate-800">
                <table class="w-full text-sm text-left text-slate-400">
                    <thead class="text-xs text-slate-200 uppercase bg-slate-800">
                        <tr><th class="px-4 py-3">Order ID</th><th class="px-4 py-3">Email</th><th class="px-4 py-3">Total</th><th class="px-4 py-3">Actions</th></tr>
                    </thead>
                    <tbody id="adm-orders"></tbody>
                </table>
            </div>

            <h3 class="text-white font-bold mb-3 border-l-4 border-blue-500 pl-3">Customer Database & Payouts</h3>
            <div class="bg-slate-900 rounded overflow-x-auto border border-slate-800">
                <table class="w-full text-sm text-left text-slate-400">
                    <thead class="text-xs text-slate-200 uppercase bg-slate-800">
                        <tr><th class="px-4 py-3">Name</th><th class="px-4 py-3">Email</th><th class="px-4 py-3">Phone</th><th class="px-4 py-3">Payout Action</th></tr>
                    </thead>
                    <tbody id="adm-users-list"></tbody>
                </table>
            </div>
        </div>
    </section>

    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hide" onclick="if(event.target === this) this.classList.add('hide')">
        <div class="absolute right-0 h-full w-full md:w-96 bg-slate-800 p-6 shadow-xl slide-in flex flex-col">
            <h2 class="text-2xl font-bold text-white mb-4">Your Cart</h2>
            <div id="cart-items" class="mb-4 text-slate-300 flex-grow overflow-y-auto"></div>
            <div class="border-t border-slate-700 pt-4">
                <div class="flex justify-between text-xl font-bold text-white mb-4"><span>Total</span><span id="cart-total" class="text-orange-500">R0</span></div>
                <button onclick="checkout()" id="pay-btn" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded font-bold">Pay with Yoco</button>
            </div>
        </div>
    </div>

    <div id="verify-modal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hide">
        <div class="bg-slate-800 p-6 rounded-xl max-w-sm w-full mx-4 text-center border border-orange-500">
            <h3 class="text-xl font-bold text-white mb-2">Verify Email</h3>
            <p class="text-slate-400 text-sm mb-4">Code sent to <span id="v-email" class="text-white font-mono"></span></p>
            <input type="text" id="v-otp" placeholder="123456" class="w-full bg-slate-700 rounded py-2 px-4 text-center text-xl tracking-widest text-white mb-4 border border-slate-600">
            <button onclick="submitVerify()" class="w-full bg-orange-500 text-white py-2 rounded font-bold">Verify & Login</button>
        </div>
    </div>

    <div id="payout-modal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hide">
        <div class="bg-slate-800 p-6 rounded-xl max-w-sm w-full mx-4 border border-blue-500">
            <h3 class="text-lg font-bold text-white mb-4">Process Payout</h3>
            <p class="text-slate-400 text-sm mb-2">To: <span id="pay-email" class="text-white"></span></p>
            <input type="number" id="pay-amt" placeholder="Amount (ZAR)" class="w-full bg-slate-700 rounded py-2 px-4 text-white mb-4 border border-slate-600">
            <button onclick="sendPayout()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded font-bold">Confirm Transfer</button>
            <button onclick="document.getElementById('payout-modal').classList.add('hide')" class="w-full mt-2 text-slate-500 text-sm">Cancel</button>
        </div>
    </div>

    <script>
        // --- ROUTER ---
        function router(view) {
            ['home', 'login', 'dashboard', 'admin'].forEach(id => document.getElementById(id).classList.add('hide'));
            document.getElementById(view).classList.remove('hide');
            
            if(view === 'dashboard' && currentUser) loadDashboard();
            if(view === 'admin') loadAdminData();
            
            updateNav();
        }

        function updateNav() {
            const ui = document.getElementById('auth-ui');
            const dashBtn = document.getElementById('nav-dash');
            const adminBtn = document.getElementById('admin-link');
            const cartBtn = document.getElementById('cart-btn');
            
            if(currentUser) {
                ui.innerHTML = `<button onclick="logout()" class="text-slate-400 hover:text-white text-sm ml-4">Logout</button>`;
                dashBtn.classList.remove('hide');
                cartBtn.classList.remove('hide');
                document.getElementById('cart-badge').innerText = cart.length;
                document.getElementById('cart-badge').classList.toggle('hide', cart.length === 0);
                if(currentUser.role === 'Admin') adminBtn.classList.remove('hide');
            } else {
                ui.innerHTML = `<button onclick="router('login')" class="bg-slate-700 px-4 py-2 rounded text-sm text-white">Login</button>`;
                dashBtn.classList.add('hide');
                adminBtn.classList.add('hide');
                cartBtn.classList.add('hide');
            }
        }

        // --- AUTH ---
        function formatPhone(input) {
            input.value = input.value.replace(/\D/g, ''); // Only numbers allowed visually
        }

        function toggleAuth(tab) {
            document.getElementById('login-form').classList.toggle('hide', tab !== 'login');
            document.getElementById('register-form').classList.toggle('hide', tab !== 'register');
            document.getElementById('tab-l').classList.toggle('text-orange-500', tab === 'login');
            document.getElementById('tab-r').classList.toggle('text-orange-500', tab === 'register');
        }

        document.getElementById('register-form').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('r-btn');
            btn.innerText = "Processing...";
            
            try {
                const res = await apiCall({
                    action: "register",
                    name: document.getElementById('r-name').value,
                    email: document.getElementById('r-email').value,
                    phone: document.getElementById('r-phone').value,
                    password: document.getElementById('r-pass').value
                });
                if(res.status === "success") {
                    document.getElementById('v-email').innerText = document.getElementById('r-email').value;
                    document.getElementById('verify-modal').classList.remove('hide');
                } else alert(res.message);
            } catch(e) { alert(e.message); }
            btn.innerText = "Create Account";
        };

        async function submitVerify() {
            const email = document.getElementById('v-email').innerText;
            const code = document.getElementById('v-otp').value;
            const res = await apiCall({action: "verify", email, otp: code});
            if(res.status === "success") {
                currentUser = res.user;
                localStorage.setItem('fixrest_user', JSON.stringify(currentUser));
                document.getElementById('verify-modal').classList.add('hide');
                router('dashboard');
            } else alert(res.message);
        }

        document.getElementById('login-form').onsubmit = async (e) => {
            e.preventDefault();
            const res = await apiCall({
                action: "login",
                email: document.getElementById('l-email').value,
                password: document.getElementById('l-pass').value
            });
            if(res.status === "success") {
                currentUser = res.user;
                localStorage.setItem('fixrest_user', JSON.stringify(currentUser));
                router(currentUser.role === 'Admin' ? 'admin' : 'dashboard');
            } else alert(res.message);
        };

        // --- DASHBOARD ---
        async function loadDashboard() {
            document.getElementById('user-name').innerText = currentUser.name;
            const res = await apiCall({action: "get_dashboard", userId: currentUser.id});
            if(res.status === "success") {
                document.getElementById('order-list').innerHTML = res.orders.map(o => `
                    <tr class="border-b border-slate-700">
                        <td class="p-3 font-mono text-xs">${o.id}</td>
                        <td class="p-3 text-xs text-slate-400">${new Date(o.date).toLocaleDateString()}</td>
                        <td class="p-3 text-orange-400">R${o.total}</td>
                        <td class="p-3"><span class="px-2 py-1 rounded text-xs ${o.status === 'Paid' ? 'bg-green-900 text-green-200' : 'bg-yellow-900 text-yellow-200'}">${o.status}</span></td>
                    </tr>`).join('');
                
                document.getElementById('notif-list').innerHTML = res.notifications.length ? res.notifications.map(n => `
                    <div class="bg-slate-700 p-3 rounded text-sm mb-2 border-l-4 ${n.type === 'success' ? 'border-green-500' : 'border-blue-500'}">
                        <p class="text-white">${n.msg}</p>
                        <p class="text-xs text-slate-400 mt-1">${new Date(n.date).toLocaleDateString()}</p>
                    </div>`).join('') : '<p class="text-slate-500 text-sm">No notifications</p>';
            }
        }

        // --- ADMIN ---
        async function loadAdminData() {
            if(!currentUser || currentUser.role !== 'Admin') return router('home');
            const res = await apiCall({action: "get_admin_data", userId: currentUser.id});
            
            if(res.status === "success") {
                document.getElementById('adm-sales').innerText = "R" + res.totalSales;
                document.getElementById('adm-users').innerText = res.users.length;
                
                const pending = res.orders.filter(o => o.status === "Pending");
                document.getElementById('adm-orders').innerHTML = pending.length ? pending.map(o => `
                    <tr class="bg-slate-800 border-b border-slate-700">
                        <td class="px-4 py-3 font-mono text-xs">${o.id}</td>
                        <td class="px-4 py-3 text-white text-xs">${o.email}</td>
                        <td class="px-4 py-3 text-orange-400 font-bold">R${o.total}</td>
                        <td class="px-4 py-3">
                            <button onclick="confirmPay('${o.id}')" class="bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700">Confirm</button>
                            <button onclick="generateInvoice('${o.id}', '${o.email}', ${o.total})" class="bg-blue-600 text-white px-2 py-1 rounded text-xs ml-1">PDF</button>
                        </td>
                    </tr>`).join('') : '<tr><td colspan="4" class="p-4 text-center text-slate-500">No pending orders</td></tr>';

                document.getElementById('adm-users-list').innerHTML = res.users.map(u => `
                    <tr class="bg-slate-800 border-b border-slate-700">
                        <td class="px-4 py-3 text-white">${u.name}</td>
                        <td class="px-4 py-3 text-xs">${u.email}</td>
                        <td class="px-4 py-3 text-xs">${u.phone}</td>
                        <td class="px-4 py-3"><button onclick="openPayout('${u.email}', '${u.name}', '${u.id}')" class="bg-slate-700 border border-slate-600 text-slate-300 px-2 py-1 rounded text-xs hover:bg-slate-600">Pay User</button></td>
                    </tr>`).join('');
            }
        }

        async function confirmPay(orderId) {
            if(!confirm("Confirm payment received?")) return;
            const res = await apiCall({action: "confirm_payment", orderId: orderId});
            alert(res.message);
            loadAdminData();
        }

        // --- PAYOUT (Cash Out) ---
        let payoutTarget = {};
        function openPayout(email, name, id) {
            payoutTarget = {email, name, id};
            document.getElementById('pay-email').innerText = email;
            document.getElementById('payout-modal').classList.remove('hide');
        }
        
        async function sendPayout() {
            const amt = document.getElementById('pay-amt').value;
            if(!amt) return alert("Enter amount");
            const res = await apiCall({
                action: "send_payout",
                userId: payoutTarget.id,
                email: payoutTarget.email,
                name: payoutTarget.name,
                amount: amt
            });
            alert(res.message);
            document.getElementById('payout-modal').classList.add('hide');
        }

        // --- CART ---
        function addToCart(name, price) {
            if(!currentUser) { toggleAuth('login'); router('login'); return; }
            cart.push({name, price});
            localStorage.setItem('fixrest_cart', JSON.stringify(cart));
            updateNav();
        }
        function renderCart() {
            const total = cart.reduce((a,b) => a+b.price, 0);
            document.getElementById('cart-total').innerText = "R" + total;
            document.getElementById('cart-items').innerHTML = cart.map(i => `<div class="flex justify-between border-b border-slate-700 py-2"><span>${i.name}</span><span>R${i.price}</span></div>`).join('');
        }
        async function checkout() {
            if(cart.length === 0) return;
            const btn = document.getElementById('pay-btn');
            btn.innerText = "Processing...";
            try {
                const res = await apiCall({
                    action: "create_checkout",
                    userId: currentUser.id,
                    email: currentUser.email,
                    total: cart.reduce((a,b) => a+b.price, 0),
                    cart: cart
                });
                if(res.status === "success") {
                    cart = []; localStorage.setItem('fixrest_cart', []);
                    alert("Order created! Check your email/dashboard.");
                    router('dashboard');
                    document.getElementById('cart-modal').classList.add('hide');
                } else alert(res.message);
            } catch(e) { alert(e.message); }
            btn.innerText = "Pay with Yoco";
        }

        // --- UTILS ---
        async function apiCall(data) {
            const res = await fetch(API_URL, {method:'POST', body: JSON.stringify(data)});
            return await res.json();
        }
        function logout() { localStorage.removeItem('fixrest_user'); currentUser = null; router('home'); }
        
        function generateInvoice(id, name, total) {
            const date = new Date().toLocaleDateString();
            const html = `<!DOCTYPE html><html><head><style>body{font-family:Arial;margin:40px;background:#f5f5f5}.invoice{max-width:800px;margin:auto;background:white;padding:30px;border-radius:8px}.header{display:grid;grid-template-columns:1fr auto;margin-bottom:30px}.logo{color:#f97316;font-size:24px;font-weight:bold}.title{color:#0f172a;text-align:right}.columns{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-bottom:30px}.column{padding:20px;background:#f8fafc;border-radius:6px}.table{width:100%;border-collapse:collapse;margin:20px 0}.table th{background:#0f172a;color:white;padding:12px}.table td{padding:12px;border-bottom:1px solid #ddd}.total{background:#f97316;color:white;padding:20px;border-radius:6px;text-align:center;font-size:24px;font-weight:bold;margin:20px 0}.footer{text-align:center;margin-top:30px;padding-top:20px;border-top:1px solid #ddd;color:#666}</style></head><body><div class="invoice"><div class="header"><div class="logo"><span style="background:#f97316;color:white;padding:5px 10px;border-radius:4px;margin-right:10px;">üè†</span>FixRest</div><div class="title"><h2 style="color:#f97316;margin:0;">INVOICE</h2><p style="margin:5px 0;">#${id}</p></div></div><div class="columns"><div class="column"><h3 style="color:#0f172a;margin-top:0;">Bill To:</h3><p style="font-weight:bold;margin:0;">${name}</p><p style="color:#666;margin:5px 0;">Date: ${date}</p></div><div class="column"><h3 style="color:#0f172a;margin-top:0;">From:</h3><p style="font-weight:bold;margin:0;">FixRest</p><p style="color:#666;margin:5px 0;">support@fixrest.co.za</p></div></div><table class="table"><thead><tr><th>Service</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead><tbody><tr><td>Service Package</td><td>1</td><td>R${total}</td><td><strong>R${total}</strong></td></tr></tbody></table><div class="total">TOTAL DUE: R${total}</div><div class="footer"><p>Thank you for your business!</p><p style="font-size:14px;">¬© 2025 FixRest</p></div></div><script>window.print();<\/script></body></html>`;
            const win = window.open('', '_blank'); win.document.write(html); win.document.close();
        }

        // Init
        updateNav();
        if(currentUser) router(currentUser.role === 'Admin' ? 'admin' : 'dashboard');
        else router('home');
    </script>
</body>
</html>
